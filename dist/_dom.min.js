const _dom=function(){const h={};return function(){class o{constructor(t,e){this._catcher=t,this._args=e,this._data=null}get result(){return this._data?this._data.value:void 0}set result(t){this.touch(),this._data.value=t}get method(){return this._catcher.method}get arguments(){return this._args.slice(0)}get args(){return this._args.slice(0)}get untouched(){return!this._data}touch(){this._data||(this._data={})}apply(t){return this.result=this._catcher.callMethod(t)}flush(){return this.apply(this.arguments)}pipe(t){return this.result=t[this.method].apply(t,this.args)}}h["CatchMethod.js"]={CatchMethod:class{constructor(t,e,s){if(!t.constructor||!t.constructor.prototype||"function"!=typeof t.constructor.prototype[e])throw console.error("----------_dom.catchMethod Error"),console.log("target:",t),["","_dom.catchMethod Error:",'The target dont have a constructor prototype with a method "'+e+'".'].join("\n");this.target=t,this.method=e,this.callback=s,this.proto=t.constructor.prototype,this.attached=!1}callMethod(t){return this.proto[this.method].apply(this.target,t)}fork(t){}attach(){if(!this.attached){this.attached=!0;const s=this;this.target[this.method]=(...t)=>{t=new o(s,t);let e=s.callback(t);return void 0===e&&(t.untouched&&t.flush(),e=t.result),e}}return this}detach(){return this.attached&&(this.attached=!1,this.target[this.method]=this.proto[this.method].bind(this.target)),this}}}}()(function(){h["DomCore.js"]={DomCore:class{constructor(){}static get uid(){return Date.now().toString(16)+"-"+Math.floor(1e12*Math.random()).toString(16)}static dom(t,e,s,o){let r=arguments,n;try{n="string"==typeof o?document.createElementNS(o,t):document.createElement(t),!s&&e instanceof Array&&(s=e,e={});let r=function(t,e,s){if(void 0===t)throw"property '"+s+"' doesn't exist.";for(var o in e)"object"==typeof e[o]?r(t[o],e[o],s+"."+o):t[o]=e[o]};r(n,e,(""+t).toUpperCase()),this.append(n,s)}catch(t){throw console.error("----------_dom Error"),console.log("arguments=",r),console.log("error=",t),"_dom Error:\n"+t}return n}static append(t,s){if(!(t instanceof HTMLElement))throw"_dom.append Error:\nparameter dom must be a dom element.";if(s&&"number"==typeof s.length)if("string"==typeof s)t.innerHTML+=s;else for(let e=0;e<s.length;e++)if("string"==typeof s[e])t.appendChild(document.createTextNode(s[e]));else try{t.appendChild(s[e])}catch(t){throw console.error("-----------------------"),console.log("childs["+e+"]=",s[e]),console.log("error=",t),"_dom.append Error:\nparameter childs["+e+"] must be string or dom element."}}static findParent(e,s,o=10){var t=[];if(e instanceof HTMLElement||t.push('arg[0] "dom" is not an HTMLElement.'),"function"!=typeof s&&t.push('arg[1] "condition" is not a function.'),("number"!=typeof o||o<2)&&t.push('arg[2] "maxDeep" is not a number with a value > 1 ."'),t.length)throw console.error("----------_dom.findParent Error"),console.log("arguments=",arguments),"\n_dom.findParent Error:\n"+t.map(t=>"\t- "+t).join("\n");for(let t=0;t<o&&e.parentNode;t++){if(s(e))return e;e=e.parentNode}}static events(s,t){(t instanceof Array?t:[t]).forEach(e=>{(e.type instanceof Array?e.type:[e.type]).forEach(t=>s.addEventListener(e.type,e.callback))})}static objName2tagName(t){return t.split(/([A-Z])/).map((t,e)=>e%2?"-"+t.toLowerCase():t).join("")}static tagName2objName(t){return t.split(/-([a-zA-Z])/).map((t,e)=>e%2?t.toUpperCase():t).join("")}}}})()(function(){const t=h["DomCore.js"]["DomCore"];class e{constructor(){}static defaultCssRef=new Map;static get sheet(){return 0==document.styleSheets.length&&document.documentElement.appendChild(t.dom("style",[""])),document.styleSheets[document.styleSheets.length-1]}static rule(t,e,s,r,n){if("string"!=typeof t||!t.length)throw console.error("----------_dom.rule Error"),console.log("selector=",t),"\n_dom.rule Error:\nselector is not a valid css query.";(s=s instanceof CSSStyleSheet?s:this.sheet).insertRule(t+"{\n\n}",s.cssRules.length);let i=s.cssRules[s.cssRules.length-1];if(e){let o=(t,e)=>{for(var s in t)"object"==typeof t[s]?(i.appendRule(s+"{\n\n}"),o(t[s],i.cssRules[i.cssRules.length-1])):e.style[s]=t[s],r&&s in n&&(r[n[s]]=r[s])};o(e,i)}return i}static rules(t,e,s=""){let o="";s&&(t={["."+(o=s+"-"+DomTools.uid)]:t});var r,n={},i=this.getRulesData(t);for(r in e instanceof CSSStyleSheet||(e=this.sheet),i.rules){try{n[r]=this.rule(r,i.rules[r],e,n,i.alias)}catch(t){console.warn('_dom.rules Warning:\nInsertion of rule "'+r+'" failed!\n\n'+t)}r in i.alias&&(n[i.alias[r]]=n[r])}return o?{className:o,rules:n}:n}static getRulesData(t){function c(o,r,e,n){let t={},i;e.length&&(i=e.join(""));for(let s in o){var a=s.charAt(0);if("$"===a)r[s.substr(1)]=o[s];else if("@"===a){var l={rules:{}};c(o[s],Object.assign({},r),[],l),n.rules[s]=l.rules}else if(e.length&&"&"!==a)if("alias"===s)u.alias[i]=o[s];else{let e=o[s]+"";Object.keys(r).forEach(t=>{e=-1<e.indexOf(t)?e.split(t).join(r[t]):e}),t[s]=e}else(e.length?s.substr(1):s).split(",").forEach(t=>{c(o[s],Object.assign({},r),e.concat([t]),n||u)})}i&&(n.rules[i]?Object.assign(u.rules[i],t):n.rules[i]=t)}let u={rules:{},alias:{}};return c(t,{},[]),u}static defaultCss(t,e=!1){let r,n;if(t=(t=t instanceof HTMLElement?(r=t).tagName:t).toLowerCase(),e||r||!this.defaultCssRef.has(t)){let s,o=document.documentElement;try{s=document.createElement(t),o.appendChild(s);let e=window.getComputedStyle(s);n=new Map,Object.keys(e).map(t=>e[t]).filter(t=>"-"!==t.charAt(0)&&""!==e[t]).forEach(t=>n.set(t,e[t])),r||this.defaultCssRef.set(t,n),o.removeChild(s)}catch(t){throw s&&s.parentNode&&o.removeChild(s),"\n_dom.properties Error:\n"+t}}else n=this.defaultCssRef.get(t);return n}}h["DomCss.js"]={DomRules:class{constructor(){}},DomCss:e}})()(function(){class e{constructor(t,e=""){this.prefix=(e="object"!=typeof e?{prefix:(e||"")+""}:e).prefix||"",this.defaultValue=e.defaultValue||"",this.initValue=e.initValue||"",this.map=new Map}get themes(){return Array.from(this.map.keys())}clone(){var t=new o({prefix:this.prefix,defaultValue:this.defaultValue,initValue:this.initValue});return t._priv.map=new Map(this.map),t}get(t){return this.map.get(t)}add(t,e={}){this.map.set(t,e)}addData(t){for(var e in t)this.add(e,t[e])}extract(){const e={};return this.themes.forEach(t=>{e["&."+this.prefix+t]=this.map.get(t)}),e}extractRoot(t){return{[t]:this.extract()}}filterStatus(t,e=!1){return this.map.has(t)?t:e&&this.map.has(this.initValue)?this.initValue:this.map.has(this.defaultValue)?this.defaultValue:""}attach(t,e=""){return new s(this,t,this.filterStatus(e,!0))}}class s{constructor(t,e,s=""){this.domstat=t,this.target=e,this.prefix=t.prefix,this._current=this._status=s,this.update()}get status(){return this._status}set status(t){this.select(t)}update(){this.domstat.themes.forEach(t=>{t===this._status?this.target.classList.add(this.prefix+t):this.target.classList.remove(this.prefix+t)})}select(t,e=!1){t=this.domstat.filterStatus(t);e=e||this._status!==t;this._status=t,e&&this.update()}}class o{constructor(t=""){this._priv=new e(this,t)}get themes(){return this._priv.themes}clone(){return this._priv.clone()}get(t){return this._priv.get(t)}add(t,e={}){return this._priv.add(t,e),this}addData(t){return this._priv.addData(t),this}extract(){return this._priv.extract()}extractRoot(t){return this._priv.extractRoot(t)}attach(t,e=""){return this._priv.attach(t,e)}}h["DomCssStatus.js"]={DomCssStatus:o}})()(function(){const r=h["settings.js"]["modelref"],n=h["DomCss.js"]["DomCss"];class e{constructor(t,e){Object.defineProperty(this,"tagName",{get:function(){return t.tagName}}),t.cssRules&&(s=t.getRules(),Object.defineProperty(this,"rules",{get:function(){return s}})),Object.defineProperty(this,"services",{get:function(){return t.module.servicesProxy}});var s,o=t.constructor.apply(this,e);if(!(o instanceof HTMLElement))throw console.error("-----------------------"),console.log("tagName=",t.tagName),console.log("constructor=",t.constructor),console.log("this.dom=",o),"\n_dom.model Error:\nconstructor must return an HTMLElement.";o[r]&&(this._super=o[r]),"dom"in this||Object.defineProperty(this,"dom",{get:function(){return o}})}}h["DomModel.js"]={DomModel:class{constructor(t,e,s,o){let r;this.module=t,this.tagName=e,this.constructor=s,this.cssRules="function"==typeof o?o:"object"==typeof o?function(){return o}:0,this.getRules=function(t){return r=this.cssRules&&!r?n.rules(this.cssRules()):r}}build(t){var e=this.instance(t);return Object.defineProperty(e.dom,r,{get:function(){return e},configurable:!0}),e.dom}instance(t){return new e(this,t)}}}})()(function(){class e{constructor(t,e){this._priv={service:t,args:e}}get module(){return this._priv.service.domModule}get arguments(){return this._priv.args}get services(){return this._priv.service.domModule.servicesProxy}}h["DomService.js"]={DomService:class{constructor(t,e,s,o){this.domModule=t,this.name=e,this._constructor=s,this.args=o,this._instance=null,this._services=null}get instance(){if(!this._instance){let t;if(this.args instanceof Array?t=this.args:"function"==typeof this.args&&(t=this.args()),!(t instanceof Array))throw console.error('----------_dom.service["'+this.name+'"] Error'),console.log("args =",this.args),console.log("result =",t),'\n_dom.service Error:\n "args" must be an array or a function returning an array.';this._instance=new this._constructor(new e(this.domModule,t))}return this._instance}},DomServicesProxy:class{constructor(t){this._priv={services:null},this.module=t}get services(){return this._services||(this._priv.services=new Proxy({},{get:(t,e)=>{var s=this.module.getService(e,!0);if(s)return s;throw console.error("-----------------------"),console.log("tagName\t=",tagName),console.log("service name\t=",e),'\n_dom.model.services Error:\nservice "'+e+'" not found.'}})),this._priv.services}}}})()(function(){h["settings.js"]={debug:!1,modelref:"__dom",moduleref:"__module__"}})()(function(){const a=h["DomCore.js"]["DomCore"],c=h["settings.js"]["modelref"],l=new Map;h["DomShadow.js"]={DomShadow:class u{constructor(r,t,e,n){var s,o=r.attachShadow({mode:"open"}),i=(n=n||[],e.slice(1).map((t,e)=>{let s,o=e+1;if(r.hasAttribute(t))if(s=r.getAttribute(t),"function"==typeof n[o])s=n[o](s);else if("boolean"===n[o])s=!["false","0","off"].includes(s)&&!!s.length;else if("int"===n[o])s=parseInt(s);else if("number"===n[o])s=parseFloat(s);else if("function"===n[o])s=new Function(""+s).bind(r);else if("string"!==n[o])try{s=JSON.parse(s)}catch(t){}return s})),t=(e=[t].concat(i),_dom.apply(null,e)),a=(o.appendChild(t),[]),l=t[c].rules;for(s in l)a.push(l[s].cssText);o.appendChild(_dom("style",{type:"text/css",textContent:a.join("\n")}))}static modelShadowed(t){return l.has(t)}static modelShadow(s,o,r){if(!this.modelShadowed(o)){if(!s.hasModel(o))throw["","_dom.modelShadow Error:",'argument[0] "tagName"="'+o+'" has no model declared.'].join("\n");{s.rootModule,s.getModel(o),s=a.tagName2objName(o);let t=(_models[o].constructor+"").split(")",2)[0].split("(")[1].split(","),e=t.map(t=>r.hasOwnProperty(t)?r[t]:0);class i extends HTMLElement{constructor(){super(),new u(this,o,t,e)}}var n={name:s,[s]:class extends i{}};l.set(o,n),customElements.define(o,n[s])}}}}}})()(function(){const e=h["settings.js"]["moduleref"],o=h["DomCss.js"]["DomCss"],s=h["DomShadow.js"]["DomShadow"],n=h["DomCssStatus.js"]["DomCssStatus"],i=h["DomCore.js"]["DomCore"],a=h["DomUtils.js"]["DomUtils"],l=h["CatchMethod.js"]["CatchMethod"];h["_dom.builder.js"]=function(r){function t(t,e,s,o){return r.make(t,e,s,o)}return Object.defineProperty(t,e,{value:r,writable:!1,enumerable:!1}),Object.defineProperty(t,"moduleName",{get:()=>r.name}),Object.defineProperty(t,"uid",{get:()=>i.uid}),Object.defineProperty(t,"models",{get:()=>r.availableModels}),Object.defineProperty(t,"sheet",{get:()=>o.sheet}),Object.defineProperty(t,"services",{get:()=>r.servicesProxy}),t.append=function(t,e){i.append(t,e)},t.model=function(t,e,s,o){return r.model(t,e,s,o)},t.addService=function(t,e,s){return r.addService(t,e,s)},t.has=function(t){return r.hasModel(t)},t.instance=function(t,e){return r.instance(t,e)},t.findParent=function(t,e,s=10){return i.findParent(t,e,s)},t.events=function(t,e){return i.events(t,e)},t.defaultCss=function(t,e=!1){return o.defaultCss(t,e)},t.rule=function(t,e,s){return o.rule(t,e,s)},t.rules=function(t,e,s=""){return o.rules(t,e,s)},t.modelShadowed=function(t){return s.modelShadowed(t)},t.modelShadow=function(t,e){return s.modelShadow(r,t,e)},t.module=function(t){return r.module(t)._dom},t.export=function(t){return r.export(t)._dom},t.import=function(t){r.import(t)},t.cssStatus=function(t=""){return new n(t)},t.scrollTo=function(t,e,s){a.scroll.to(t,e,s)},t.catchMethod=function(t,e,s){return new l(t,e,s).attach()},t}})()(function(){const r=h["settings.js"]["moduleref"],e=h["_dom.builder.js"],n=h["DomCore.js"]["DomCore"],i=h["DomModel.js"]["DomModel"],a=h["DomShadow.js"]["DomShadow"],{DomService:o,DomServicesProxy:s}=h["DomService.js"];let l=null,c=1;h["DomModule.js"]={DomModule:class u{constructor(t){l=l||this,this.id=c++,this.name=t||"mod_module_"+this.id,this.models=new Map,this.publicModels=new Map,this.services=new Map,this.publicServices=new Map,this.modules=[],this._dom=e(this),this.parent=null,this._servicesProxy=new s(this)}static get rootModule(){return l}get rootModule(){return l}get availableModels(){const e=[];return this.modules.forEach(t=>e.push(...t.availableModels)),e.concat(Array.from(this.publicModels.keys()))}get parentPile(){return this.parent?this.parent.pile:[]}get pile(){return this.parent?[this].concat(this.parent.pile):[this]}get servicesProxy(){return this._servicesProxy.services}findModule(t){if(t(this))return this;for(var e of this.modules)if(e=e.findModule(t))return e}module(t){return new u(t)}clone(t=null,e=null){t=t||{};var s=new u;return s.parent=e,s.models=new Map(t.models||this.models),s.publicModels=new Map(t.publics||this.publicModels),s.modules=this.modules.map(t=>t.clone(null,this)),s}export(t){var e,s=t instanceof Array?t:[t];if(s.length){if((e=s.filter(t=>!this.has(t))).length)throw console.error("----------_dom.export Error"),console.log("models=",t),console.log("not found=",e),console.log("availables=",this.availableModels),"\n_dom.export Error:\nSome models are not found.";{let e={publics:new Map};return s.forEach(t=>e.publics.set(t,!0)),this.clone(e)}}throw console.error("----------_dom.export Error"),console.log("models=",t),'\n_dom.export Error:\nlist "models" is empty.'}import(t){const s=[];var e=(t instanceof Array?t:[t]).map((t,e)=>t instanceof u?t:t&&t[r]instanceof u?t[r]:void s.push(e));if(s.length)throw console.error("----------_dom.import Error"),console.log("domModules=",t),"\n_dom.import Error:\ndomModules not importables at indexes ("+s.join(" ,")+" ) .";let o=this.parentPile;e.map(s=>{if(this.id===s.id)throw'\n_dom.import Error:\nModule "'+fm.name+'" cant import Himself.';if(this.modules.find(t=>t.id===s.id))throw'\n_dom.import Error:\nModule "'+fm.name+'" allready in "'+this.name+'" collection.';o.map(e=>{if(s.findModule(t=>t.id===e.id))throw console.error("----------_dom.import Error"),console.log("domModules=",t),'\n_dom.import Error:\nCyclic reference for module "'+s.name+'".'}),this.modules.push(s.clone(null,this))})}addService(t,e,s){e=new o(this,t,e,s),this.services.set(t,e),this.publicServices.set(t,!0)}hasService(e){return!(!this.publicServices.has(e)&&!this.modules.find(t=>t.hasService(e)))}getService(t,e=!1){return this.publicServices.has(t)||e&&this.services.has(t)?this.services.get(t).instance:this.modules.find(t=>t.getService(tagName))||null}hasModel(e){return!(!this.publicModels.has(e)&&!this.modules.find(t=>t.hasModel(e)))}getModel(e){return this.publicModels.has(e)?this.models.get(e):this.modules.find(t=>t.getModel(e))||null}instance(t,e){if(this.hasModel(t))return this.getModel(t).instance(arguments);throw console.error("----------_dom.instance Error"),console.log("arguments=",arguments),'\n_dom.instance Error:\ntagName "'+t+'" not found in models.'}make(t,e,s,o){var r=arguments;return this.hasModel(t)?this.getModel(t).build(r):n.dom(t,e,s,o)}model(t,e,s,o){if(-1===t.indexOf("-")&&console.warn('_dom.model suspect tagName "'+t+'" should contain at least one "-" to avoid conflict with natives HTMLElements.'),this.models.has(t)||this.hasModel(t))throw'\n_dom.model Error:\ntagName "'+t+'" allready exists in this module.';if("function"!=typeof e)throw console.error("----------_dom.model Error"),console.log("tagName=",t),console.log("constructor=",e),"\n_dom.model Error:\nconstructor must be a function.";this.models.set(t,new i(this,t,e,s)),this.publicModels.set(t,!0),o&&a.modelShadow(this,t,o)}}}})()(function(){class t{}t.scroll={offset:function(e,s,o){if(e.contains(s)){o="number"==typeof o?[o,o]:o instanceof Array?[0,1].map(t=>o[t]||0):[0,0];var r=[0,0];let t=s;for(;t!==e;)r[0]+=t.offsetWidth,r[1]+=t.offsetHeight,t=t.parentNode;return r.map((t,e)=>t-o[e])}throw console.error("----------_dom.scrollTo Error"),console.log("container=",e),console.log("target=",s),"_dom.scrollOffset Error: target not found in container"},value:function(t,e,s){const o=[t.scrollLeft,t.scrollTop];return this.offset(t,e,s).map((t,e)=>Math.max(0,t-o[e]))},to:function(t,e,s){e=this.value(t,e,s);t.scrollTop=e[0],t.scrollLeft=e[1]}},h["DomUtils.js"]={DomUtils:t}})()(function(){var t=h["DomModule.js"]["DomModule"];h["_dom.js"]=(new t)._dom})(),h["_dom.js"]}();try{module.exports=_dom}catch(t){}
//# sourceMappingURL=_dom.js.map